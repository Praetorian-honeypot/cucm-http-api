cucm-http-api
=============

[Online documentation](https://cucm-http-api.readthedocs.org)

Objectives
----------

The aim of this project is to provide a simple, technical HTTP API (with a JSON output) to expose some services from CUCM / AXL APIs.

Phone information, updating speeddials are the first steps of this project which will have full documentation.

Requirements
------------

This is a Java project, you do need Maven.

AXL SOAP web services
---------------------

The schema (WSDL) from the "AXL SQL toolkit" downloaded from the CUCM administration console has been put into this repository for convenience (in the folder `cucm_schema`), the consumer classes have been generated using the command `wsimport -keep -b cucm_schema/current/AXLSOAP.xsd -Xnocompile  -s src/main/java -d bin -verbose cucm_schema/current/AXLAPI.wsdl`.

Installation
------------

Run `mvn clean install` at the root of the project.

Running
-------

You can run the application via the "fat" jar provided using supervisor or circus with the following command line:
`java -jar target/cucm-http-api-1.0-SNAPSHOT.jar server src/main/resources/configuration.yml`

Configuration
--------------

You do need to configure the domain of CUCM, its user and password, see the sample configuration at `src/main/resources/configuration.yml.example`.

Code architecture
-----------------

`com.cisco` classes are consumer classes for the web service, generated by wsimport.

`uk.ac.ox.it.cha` is the main application.

`uk.ac.ox.it.cha.configuration` contains objects that represent the configuration file required by the application (see `src/main/resources/configuration.yml.example`).

`uk.ac.ox.it.cha.representations` contains objects that represent the main representation to be produced or consumed by our application.

`uk.ac.ox.it.cha.resources` contains the resources of the application, defined by a path.

`uk.ac.ox.it.cha.services` contains managed objects to access external resources (e.g. the SOAP web service).

Security considerations
-----------------------

It is not recommended to expose this API (which remains technical) to a wide audience, it has been developed as a middleware. The recommended configuration is to bind the host to a local interface.

Basic auth is mandatory to query the API, username and password have to be defined in the configuration file.

Examples
--------

`curl -u user:password "http://127.0.0.1:8080/phone?dirn=14015"` (GET) gives information on the phone associated with this directory number (only one phone atm).

`curl -u user:password -H "Accept: application/json" -H "Content-Type: application/json" -X POST --data @data.json "http://127.0.0.1:8080/phone/speeddials?dirn=14015"` (POST) updates the speeddials information (e.g. data.json: `[{"index": "2", "dirn": "13710"},{"index": "9", "dirn": "13710"}]`)
